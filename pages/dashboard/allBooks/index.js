import Head from "next/head";
import { useState } from "react";
import Header from "../../../components/Dashboard/Header";
import Sidebar from "../../../components/Dashboard/Sidebar";
import { FaEdit, FaTrash } from "react-icons/fa";
import { getBooks } from "../../api/books";
import Image from "next/image";

const index = ({ booksData }) => {
	const [close, setClose] = useState(false);
	console.log(booksData);
	return (
		<>
			<Head>
				<title>All Books</title>
				<meta name="description" content="Generated by create next app" />
				<link rel="icon" href="/favicon.ico" />
			</Head>

			<main className="bg-white flex items-start justify-center">
				<div
					className={
						close
							? "w-0 overflow-hidden transition-all duration-300 translate-x-[-100%]"
							: "transition-all duration-300 translate-x-0 w-60"
					}
				>
					<Sidebar />
				</div>
				<section className="w-full">
					<Header close={close} setClose={setClose}></Header>
					<div className="m-6">
						<h1 className="text-2xl pb-5 rounded-md">All Books</h1>
						<div className="overflow-x-auto">
							<table className="table w-full">
								<thead>
									<tr>
										<th className="bg-secondary/10">SL</th>
										<th className="bg-secondary/10">Book Image</th>
										<th className="bg-secondary/10">Book Name</th>
										
										<th className="bg-secondary/10">Author</th>
										<th className="bg-secondary/10">Is Best Seller</th>
										<th className="w-10 bg-secondary/10">Actions</th>
									</tr>
								</thead>
								<tbody>
									{booksData.map( (book, index) => <tr key={book._id}>
										<td className="bg-primary/10">{index + 1}</td>
										<td className="bg-primary/10"><Image
										 src={book.picture}
										 width={50}
										 height={100}
										 alt={book.title}
										 >
											</Image></td>
										<td className="bg-primary/10">{book.title}</td>
									
										<td className="bg-primary/10">{book.author_name}</td>
										<td className="bg-primary/10">
											<select
												className="select w-full bg-primary/10"
												defaultValue={0}
											>
												<option value="1">Yes</option>
												<option value="0">No</option>
											</select>
										</td>
										<td className="bg-primary/10">
											<button
												title="Edit"
												className=" mr-2"
											>
												<FaEdit />
											</button>
											<button title="Delete" className="text-red-600">
												<FaTrash />
											</button>
										</td>
									</tr>)}
								</tbody>
							</table>
						</div>
					</div>
				</section>
			</main>
		</>
	);
};

export async function getStaticProps() {
	try {
		const booksData = await getBooks();
		if (!booksData) {
			return {
				notFound: true,
				revalidate: 60,
			};
		}
		return {
			props: {
				booksData: JSON.parse(JSON.stringify(booksData)),
			},
			revalidate: 60,
		};
	} catch (error) {
		console.log(error);
	}
}

export default index;
